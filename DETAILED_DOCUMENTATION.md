# Excel Explorer – Detailed Documentation

> **Version:** July 15 2025  
> **Scope:** Only describes functionality that is _implemented and working today_. Planned / future items are intentionally left out.

---

## 1. Project Overview
Excel Explorer is a lightweight Python-based desktop application for rapidly **inspecting** Microsoft Excel workbooks and exporting an **interactive HTML report**.  The app is aimed at data analysts and auditors who need a quick, no-install way to answer questions such as:

* _How many sheets are in this file?_
* _Which columns are numeric vs. text?_  
* _Are there hidden sheets, charts, or external links?_
* _Can I browse a neat summary without opening Excel?_

The tool runs on **Tkinter** (no extra GUI frameworks) and uses **openpyxl** for read-only workbook inspection.


---

## 2. High-Level Architecture
```
+---------------------------+
|  excel_explorer_gui.py    |  ← Tkinter front-end
+------------+--------------+
             |  invokes
+------------v--------------+
|     analyzer.py           |  ← Workbook analysis engine
+------------+--------------+
             |  passes JSON
+------------v--------------+
|  report_generator.py      |  ← HTML / JSON exporter
+---------------------------+
```

1. **GUI Layer** – handles file selection, threading, progress feedback, and shows an embedded HTML preview.
2. **Analyzer Layer** – scans the workbook module-by-module (structure, data, formulas, visuals…).  Results are pure Python dicts.
3. **Report Generator** – converts results to:
   * `reports/<timestamp>.html` – fully styled, interactive, collapsible.
   * `reports/<timestamp>.json` – (exposed via method; UI currently exports HTML only).


---

## 3. User Interface & Workflow
| Widget | Purpose |
|---|---|
| **Select Excel File** | Choose a `.xlsx` file (read-only mode) |
| **Analyze** | Starts analysis in a background thread |
| **Stop** | Gracefully aborts the worker thread |
| **Export HTML Report** | Manually re-export the last analysis results |
| **Open HTML Report** | Opens the _most recent_ HTML in the default browser |

Other behaviour:
* A **circular progress indicator** spins and a timer counts elapsed seconds.
* When analysis completes, the Notebook automatically switches to the **Report** tab.
* Reports are auto-exported; manual export is optional.


---

## 4. Analysis Modules & Methods
All modules operate in **read-only** streaming mode – the workbook is never modified.  The analyzer intentionally samples data to keep large files snappy.

| Module | Key Metrics Captured | Implementation Notes |
|---|---|---|
| **health_checker** | File opens? corruption? | Fail-fast: openpyxl `load_workbook(read_only=True, data_only=True)` |
| **structure_mapper** | Total/visible/hidden sheets, named ranges, tables | Iterates `wb.worksheets`, `wb.defined_names`, `ws.tables` |
| **data_profiler** | Per-sheet: dimensions, estimated data vs. empty cells, data density, per-column dominant type | Samples up to `config.analysis.sample_rows` rows (default 100) and counts `int/float`, `datetime`, `str`, `bool`, `blank` |
| **formula_analyzer** | Count formulas, external refs, top complex formulas | Scans up to `config.analysis.max_formula_check` cells (default 1 000) |
| **visual_cataloger** | Charts, images, conditional formats | Reads internal openpyxl lists (`ws._charts`, `ws._images`, `ws.conditional_formatting`) |
| **connection_inspector / pivot_intelligence / doc_synthesizer** | Place-holders (execute successfully but currently return empty data) | Provide future extension points without affecting success rate |

### 4.1 Data Typing Logic
```
if isinstance(cell, (int, float)): → numeric
elif isinstance(cell, datetime):   → date
elif isinstance(cell, bool):       → boolean
elif empty string / None:          → blank
else:                              → text
```
The **dominant type** for each column is the category with the highest sample count.


---

## 5. Report Output
The generated HTML sits in `reports/` and includes:

### 5.1 Header Banner
* File name & size
* Generation timestamp (local time)

### 5.2 File & Workbook Overview (New!)
* Full path, created & modified datetimes (from `Path.stat()`)
* Collapsible ordered list of sheet names

### 5.3 Summary Cards (Grid)
* Analysis success rate, quality score, duration
* File structure stats (sheet count, named ranges, tables)
* Data stats (total cells, data cells, quality %)
* Formulas/visuals stats

### 5.4 Module Execution Section
Table-style blocks with green (✅) or red (❌) indicators for each module.

### 5.5 Sheet Details (Collapsible)
Each sheet renders as `<details>` → `<summary>` with:
* Used range (`ws.dimensions`)
* Estimated data cells / empty cells
* Inner table of columns (letter, full range, dominant data type)

### 5.6 Recommendations
Bullet-style list of autogenerated suggestions (currently basic).

All CSS is inlined – the file is completely self-contained.


---

## 6. Configuration (`config.yaml`)
Optional file that overrides analyzer limits:
```yaml
analysis:
  sample_rows: 200         # Default 100
  max_formula_check: 5000  # Default 1000
```
If the file is missing or keys absent, sensible defaults apply.


---

## 7. Command-Line / Headless Usage (optional)
While the GUI is the primary entry-point, you can drive the analyzer programmatically:
```python
from analyzer import SimpleExcelAnalyzer
from report_generator import ReportGenerator

excel_file = "my.xlsx"
results = SimpleExcelAnalyzer().analyze(excel_file)
ReportGenerator().generate_html_report(results, "reports/manual_run.html")
```


---

## 8. Directory Layout
```
excel_explorer/
├─ analyzer.py
├─ excel_explorer_gui.py
├─ report_generator.py
├─ config.yaml            # (optional)
├─ reports/               # auto-created – contains *.html
├─ requirements.txt
├─ README.md              # quick-start
└─ DETAILED_DOCUMENTATION.md   # this file
```


---

## 9. Dependencies
* Python ≥ 3.9
* **openpyxl** – Excel parsing (read-only streaming)
* **tkinter** – GUI (built-in on Windows/macOS; `python3-tk` on many Linux distros)
* Standard Lib: `pathlib`, `datetime`, `threading`, `webbrowser`, `json`, `time`, `yaml` (PyYAML)

Install them with:
```bash
pip install -r requirements.txt
```


---

## 10. Limitations / Known Gaps
* Macros (`.xlsm`) load fine _but macros are **not analysed**_.
* Very large sheets are sampled – results are **estimates**, not exhaustive counts.
* Charts/images detection relies on private openpyxl attributes; edge cases may exist.
* Place-holder modules currently return empty stubs but report as successful.


---

## 11. Contributing
Pull requests are welcome.  Please open an issue first to discuss major changes.

> © 2025 – MIT License
